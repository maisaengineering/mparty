<style type="text/css">
    /*FIX IMAGE SIZE FOR CAROUSEL*/
    .carousel-inner > .item > img,
    .carousel-inner > .item > a > img {
        display: block;
        line-height: 1;
        height: 380px;
        width: 1000px;
    }

    /* FIX IMAGE SIZE FOR GALLERY TAB.*/
    .fix_image_size > a > img
    {
        height: 165px;
        width: 220px;
    }
</style>
<div id="wrapper">
  <div class="container-fluid">
    <div class="container venue_bg" id="venue">
      <h3><%=@venue.name.titleize%></h3>
      <%= hidden_field_tag :venue_id,@venue.id %>
      <div id="carousel-example-generic" class="carousel slide venue_slider" data-ride="carousel">
        <!-- Indicators -->
        <ol class="carousel-indicators">
          <li data-target="#carousel-example-generic" data-slide-to="0" class="active"></li>
          <li data-target="#carousel-example-generic" data-slide-to="1"></li>
          <li data-target="#carousel-example-generic" data-slide-to="2"></li>
        </ol>

        <!-- Wrapper for slides -->
        <div class="carousel-inner" role="listbox">
          <% if @pictures.blank? %>
              <div class="item">
                <%= image_tag 'venue_1.jpg',width: 600,height: 500 %>
                <div class="carousel-caption"> venue three </div>
              </div>
          <% else %>
              <% @pictures.each do |picture|%>
                  <div class="item">
                    <img src="<%=picture.image.url%>" alt="..."  width="600" height="500" >
                    <div class="carousel-caption"> venue three </div>
                  </div>
              <%end%>
          <% end %>
        </div>

        <!-- Controls -->
        <a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev"> <span class="glyphicon glyphicon-chevron-left"></span> <span class="sr-only">Previous</span> </a> <a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next"> <span class="glyphicon glyphicon-chevron-right"></span> <span class="sr-only">Next</span> </a> </div>
      <div class="venue_right">
        <h4>Availability Dates</h4>
        <div>
          <div id="calendar" style="max-width: 400px;"></div>
        </div>
        <div class="row">
          <% if (params[:from_event].present? && params[:from_event]!= "false") && current_spree_user.present? %>
              <div class="btn_orange quote_btn">
                <%= link_to "Choose", new_event_path(venue_id: @venue.id), {:class => "add_this_venue_to_event"}%>
              </div>
          <% end %>
        </div>

      </div>
      <div class="venue_tab_content">
        <h4 class="review_star">Overall Rating</h4>
        <% if @venue.rates.present? %>
           <p style="position:relative;font-size:12px;color:#878484;margin-top:2px;font-weight:normal;">Based on <%= pluralize(@venue.rates.size, 'Member') %></p>
           <%= rating_for @venue, nil, readonly: true %><%= pluralize(@venue.reviews.size, 'Review')%>
        <% else %>
          <%= rating_for @venue, nil, readonly: true, noRatedMsg: "No Ratings available" %><%= pluralize(@venue.reviews.size, 'Review')%>
        <% end %>
        <br>
        <ul class="nav nav-tabs" role="tablist" id="myTab">
          <li role="presentation" class="active"><a href="#About" role="tab" data-toggle="tab">About</a></li>
          <li role="presentation"><a href="#ContactDetails" role="tab" data-toggle="tab">Contact Details</a></li>
          <li role="presentation"><a href="#Locations" role="tab" data-toggle="tab">Gallery</a></li>
          <li role="presentation"><a href="#Reviews" role="tab" data-toggle="tab">Reviews</a></li>
        </ul>
        <div class="tab-content venue_tab_margin">
          <div role="tabpanel" class="tab-pane fade in  active" id="About">
            <div class="row no_margin">
              <div class="col-md-12"> <b>Type of Venue:</b> &nbsp;
              <%unless @type_of_venues.blank?%>
                 <% @type_of_venues.each do |venue_type|%>
                   <%= venue_type.venue_type%>,
                 <%end%>
              <%else%>
                Bunquets,venues,Birth Days etc.
               <%end%>
              </div>
            </div>

            <div class="row no_margin">
              <div class="col-md-12"> <b>Types of Events:</b> &nbsp;
                <% if @venue.events.exists?%>
                    Birthdays, Marriages, Receptions, etc.
                <%else%>
                    Birthdays, Marriages, Receptions.
                <%end%>
              </div>
            </div>
            <div class="row no_margin">
              <div class="col-md-12"> <b>Description:</b> &nbsp;
                <%= @venue.description%>
              </div>
            </div>
          </div>
          <div role="tabpanel" class="tab-pane fade" id="ContactDetails">
            <div class="row no_margin">
              <div class="col-md-4">
                <br>
                <ul class="venue_ctc_details">
                  <li><b><%=@venue.name.titleize%></b></li>
                  <li><%=@venue.address1%>,<%= @venue.address2 %>,<%=@venue.city%></li>
                  <li><%=@venue.state%>,<%=@venue.country%></li>
                  <li><%=@venue.zip%></li>
                  <% if @contacts.present? %>
                    <% if @land_number.present? %>
                      <li><span class="glyphicon glyphicon-earphone"></span> &nbsp; <%= @land_number.join(",") %></li>
                    <% end %>
                    <% if @mobile_numbers.present? %>  
                      <li><span class="glyphicon glyphicon-phone"></span> &nbsp; <%= @mobile_numbers.join(",") %></li>
                    <% end %>  
                  <% end %>
                </ul>
              </div>
              <div class="col-md-8">
                <iframe src="https://www.google.com/maps/embed?pb=!1m10!1m8!1m3!1d15222.825740006923!2d78.571752!3d17.473759450000003!3m2!1i1024!2i768!4f13.1!5e0!3m2!1sen!2sin!4v1417601051402" width="100%" height="250" frameborder="0" style="border:0"></iframe>
              </div>
            </div>
          </div>

          <div role="tabpanel" class="tab-pane fade" id="Locations">
            <div class="row no_margin">
              <h4>Photos</h4>
              <%@pictures.each do |picture|%>
                  <div class="col-md-3 fix_image_size">
                    <a class="fancybox" href="<%= picture.image.url%>" rel="gallery1">
                      <img src="<%= picture.image.url(:slide_show)%>">
                    </a>
                  </div>
              <%end%>
            </div>
            <div class="row no_margin event_margin">
              <!-- <h4>Videos</h4>
               <div class="col-md-3">
                 <a class="fancybox-media" href="https://www.youtube.com/watch?v=X8XVuHi_fYo"><img src="/assets/venue_video.jpg" width="220px"></a>
               </div>
               <div class="col-md-3"></div>
               <div class="col-md-3"></div>
               <div class="col-md-3"></div>-->
            </div>
          </div>

          <div role="tabpanel" class="tab-pane fade" id="Reviews">
            <% if @can_rate_it %>
                <% if !@venue.rates.present? %>
                     <div id="first_rate_text"  style="width:151px;height:15px;margin-top:5px;margin-bottom:5px;color:green">
                         <p style="position:relative;text-align:left;font-size:12px;">Be the First to Rate it</p>
                     </div>
                     <%= rating_for @venue, nil, disable_after_rate: true %>
                <% else %>
                     <div id="first_rate_text">
                       <h4>Rate It:</h4><%= rating_for @venue, nil, disable_after_rate: true %>
                     </div>
                <% end %>
            <% end %>
            <div class="row">
              <div class="col-md-12">
                <div class="col-md-12">
                  <div class="row comment_block_btn">
                    <% if current_spree_user && @venue.can_review?(current_spree_user) %>
                        <% place_holder = @reviews.blank? ? "Be the First to Review it" : "Write your Review" %>
                        <div id="review_block" >
                        <div class="col-md-9">
                          <%= form_tag reviews_path ,remote: true,id: 'review_form' do %>
                              <%= text_area_tag :description,'',id: 'review_content',cols: 95,rows: 2 , placeholder: place_holder %>
                              <%= hidden_field_tag :resource ,'venue' %>
                              <%= hidden_field_tag :venue_id ,@venue.id %>
                        </div>
                        <div class="col-md-3">
                          <%= submit_tag 'WRITE REVIEW',class: 'btn btn-lg btn-success btn-block  ' %>
                        </div>
                        </div>
                        <% end %>
                    <% end %>
                  </div>
                  <div class="comment_block">
                    <% if @reviews.blank? %>
                        <div id="no_reviews">No Reviews</div>
                    <% else%>
                        <div id="reviews">
                          <div class="page">
                            <% @reviews.each_with_index do |review, index| %>
                                <% index = @reviews.size - index %>
                                <%= render 'reviews/review',review: review, index: index %>
                            <% end %>
                          </div>
                        </div>
                    <% end %>
                  </div>
                  <%= paginate @reviews %>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
    $(".carousel-inner div:first-child").addClass("active");
    $("#large-image").html("<img src="+$(".jcarousel ul li ").eq(0).find('img').attr('src')+">");
    $(".jcarousel a").click(function(e){
        $("#large-image").html("<img src="+$(this).find('img').attr('src')+">");

    });
    $('#myCarousel').carousel({
        interval: 1000
    })

    $('.fancybox').fancybox();

    if($("#venue_id").val()){
        $.ajax({
            url: "/venues/"+$("#venue_id").val()+"/booked_slots",
            beforeSend: function(res){},
            success: function(data){
                $('#calendar').fullCalendar({
                    header: { left: 'prev',
                        center: 'title',
                        right: 'next'
                    },
                    eventColor: '#ef5323',
                    events: data
                });
            }
        });

        $(".add_this_venue_to_event").click(function(e) {
          e.preventDefault();
          action = '/venues/'+$("#venue_id").val()+'/check_availability'
          $.ajax({url: action})
        }) 
    }
</script>

